<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>LifeOS ‚Äî Tasks & Team</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f4f6fb;--card:#fff;--line:#e6e9f2;--ink:#0f172a;--muted:#667085;--accent:#3b82f6;--accentSoft:#dbeafe;--high:#ef4444;--medium:#f59e0b;--low:#64748b;--success:#16a34a;--warn:#dc2626;--shadow:0 10px 30px -18px rgb(15 23 42 /.35)}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:'Inter',system-ui,sans-serif;color:var(--ink)}
    .app-shell{display:grid;grid-template-columns:250px minmax(0,1fr);min-height:100vh}
    .main{padding:22px 26px}
    .page-header{display:flex;justify-content:space-between;gap:12px;align-items:flex-start;margin-bottom:18px}
    .page-overline{font-size:11px;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:.08em}
    .page-title{margin:5px 0 0;font-size:28px;display:flex;gap:10px;align-items:center}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{border:1px solid var(--line);background:#fff;padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--accent);color:#fff;border-color:transparent}
    .btn.sm{padding:5px 9px;font-size:12px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
    .tabs{display:flex;gap:6px;padding:6px;background:#eef2ff;border-radius:12px;width:max-content;margin-bottom:16px}
    .tab{border:none;background:transparent;border-radius:9px;padding:8px 13px;font-weight:700;color:var(--muted);cursor:pointer}
    .tab.active{background:#fff;color:var(--ink)}
    .module{display:none}.module.active{display:block}
    .kpis{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px;margin-bottom:14px}
    .kpi{padding:14px}.kpi .v{font-size:28px;font-weight:800}.kpi .l{font-size:12px;color:var(--muted)}
    .layout-2{display:grid;grid-template-columns:minmax(0,1fr) 340px;gap:14px}
    .table-wrap{overflow:auto}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:10px;border-bottom:1px solid var(--line);text-align:left;vertical-align:top}
    tr:hover td{background:#fafbff}
    .pill{display:inline-flex;padding:2px 8px;border-radius:999px;font-size:11px;font-weight:700}
    .high{background:#fee2e2;color:#991b1b}.medium{background:#ffedd5;color:#9a3412}.low{background:#e2e8f0;color:#334155}
    .form{padding:14px;display:flex;flex-direction:column;gap:9px}
    input,select,textarea{width:100%;border:1px solid var(--line);border-radius:10px;padding:9px;font:inherit}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .steps{display:flex;flex-direction:column;gap:4px}
    .step{display:flex;gap:7px;align-items:center;font-size:12px;color:#334155}
    .team-layout{display:grid;grid-template-columns:280px minmax(0,1fr);gap:14px}
    .member{display:flex;gap:10px;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line);cursor:pointer}
    .member.active{background:#eff6ff}
    .avatar{width:32px;height:32px;border-radius:50%;display:grid;place-items:center;color:#fff;font-weight:700}
    .member small{color:var(--muted)}
    .board{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
    .col{background:#f8fafc;border:1px dashed #cbd5e1;border-radius:12px;padding:10px;min-height:260px}
    .col h4{margin:0 0 9px;font-size:13px}
    .task{background:#fff;border:1px solid var(--line);border-radius:11px;padding:9px;margin-bottom:8px;cursor:grab}
    .task.dragging{opacity:.45}
    .task-top{display:flex;justify-content:space-between;gap:6px}
    .task-title{font-weight:700}
    .task-meta{font-size:11px;color:var(--muted);margin-top:4px}
    .sticky-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
    .sticky{padding:12px;border-radius:12px;border:1px solid #facc15;background:#fef9c3;min-height:140px;display:flex;flex-direction:column;gap:8px}
    .sticky.pinned{box-shadow:0 0 0 2px #f59e0b inset}
    .sticky h5{margin:0;font-size:13px}
    .sticky small{color:#854d0e}
    .sticky .txt{white-space:pre-wrap;font-size:13px;flex:1}
    .badge{font-size:10px;background:#fff7ed;padding:2px 7px;border-radius:999px;border:1px solid #fed7aa}
    .muted{color:var(--muted)}
    @media(max-width:1100px){.layout-2,.team-layout{grid-template-columns:1fr}.kpis{grid-template-columns:repeat(2,minmax(0,1fr))}}
  </style>
</head>
<body data-page="tasks">
<div class="app-shell">
  <aside class="sidebar">
    <div class="sidebar__brand"><div class="sidebar__logo">üè°</div><div><strong>LifeOS</strong><small>Tw√≥j cyfrowy dom</small></div></div>
    <nav class="sidebar__nav"><ul class="sidebar__menu">
      <li class="sidebar__item"><a class="sidebar__link" href="index.html" data-page="index"><span class="sidebar__icon">üè†</span><span class="sidebar__label">Start</span></a></li>
      <li class="sidebar__item"><a class="sidebar__link" href="tasks.html" data-page="tasks"><span class="sidebar__icon">‚úÖ</span><span class="sidebar__label">Zadania</span></a></li>
      <li class="sidebar__item"><a class="sidebar__link" href="budget.html" data-page="budget"><span class="sidebar__icon">üí∞</span><span class="sidebar__label">Bud≈ºet</span></a></li>
      <li class="sidebar__item"><a class="sidebar__link" href="inventory.html" data-page="inventory"><span class="sidebar__icon">üì¶</span><span class="sidebar__label">Inwentarz</span></a></li>
      <li class="sidebar__item"><a class="sidebar__link" href="house.html" data-page="house"><span class="sidebar__icon">üè†</span><span class="sidebar__label">Budowa</span></a></li>
    </ul></nav>
    <div class="sidebar__footer"><strong>Work Hub</strong> Taski, kroki, notatki i priorytety.</div>
  </aside>

  <div class="main">
    <header class="page-header">
      <div>
        <div class="page-overline">Tasks + Team</div>
        <h1 class="page-title">üéØ Zadania i Notatki Zespo≈Çu</h1>
      </div>
      <div class="actions">
        <button id="export" class="btn">‚¨áÔ∏è Eksport</button>
        <button id="import" class="btn">‚¨ÜÔ∏è Import</button>
      </div>
    </header>

    <div class="tabs">
      <button class="tab active" data-tab="overview">PrzeglƒÖd</button>
      <button class="tab" data-tab="my">Moje taski</button>
      <button class="tab" data-tab="team">Zesp√≥≈Ç (drag & drop)</button>
      <button class="tab" data-tab="notes">Notatki</button>
    </div>

    <section id="mod-overview" class="module active">
      <div class="kpis" id="kpis"></div>
      <div class="card" style="padding:14px">
        <h3 style="margin:0 0 6px">Co monitorujesz w tym module</h3>
        <ul style="margin:0;padding-left:18px;display:grid;gap:6px;font-size:14px">
          <li>Taski Twoje i zespo≈Çu, z priorytetem, krokami i opcjonalnym terminem.</li>
          <li>Notatki do cz≈Çonk√≥w zespo≈Çu i do siebie (w tym notatki cykliczne: np. 1:1 weekly).</li>
          <li>Przypinanie wa≈ºnych notatek (cele roczne, najwa≈ºniejsze ustalenia).</li>
          <li>Zmiana priorytet√≥w zespo≈Çowych przez drag & drop bez kalendarza.</li>
        </ul>
      </div>
    </section>

    <section id="mod-my" class="module">
      <div class="layout-2">
        <div class="card table-wrap">
          <table>
            <thead><tr><th></th><th>Task</th><th>Kroki</th><th>Termin</th><th>Priorytet</th><th></th></tr></thead>
            <tbody id="my-rows"></tbody>
          </table>
        </div>
        <div class="card form">
          <h3 style="margin:0">Nowy task (ja)</h3>
          <input id="my-title" placeholder="Np. Plan kwartalny">
          <textarea id="my-steps" rows="4" placeholder="Kroki: ka≈ºda linia = 1 krok"></textarea>
          <div class="grid2">
            <select id="my-priority"><option value="medium">≈öredni</option><option value="high">Wysoki</option><option value="low">Niski</option></select>
            <input id="my-due" type="date">
          </div>
          <button id="my-add" class="btn primary">Dodaj task</button>
        </div>
      </div>
    </section>

    <section id="mod-team" class="module">
      <div class="team-layout">
        <div class="card" id="member-list"></div>
        <div class="card" style="padding:12px">
          <div id="team-empty" class="muted">Wybierz osobƒô po lewej, aby zarzƒÖdzaƒá zadaniami.</div>
          <div id="team-detail" style="display:none"></div>
        </div>
      </div>
    </section>

    <section id="mod-notes" class="module">
      <div class="layout-2">
        <div class="card" style="padding:12px">
          <h3 style="margin:0 0 10px">≈ª√≥≈Çte karteczki (wa≈ºne na g√≥rze)</h3>
          <div id="note-list" class="sticky-grid"></div>
        </div>
        <div class="card form">
          <h3 style="margin:0">Nowa / aktualizacja notatki</h3>
          <select id="note-person"></select>
          <input id="note-title" placeholder="Tytu≈Ç (opcjonalnie)">
          <input id="note-series" placeholder="Seria (np. 1:1 weekly) ‚Äî je≈õli istnieje, aktualizuje tƒô samƒÖ notatkƒô">
          <textarea id="note-content" rows="6" placeholder="Tre≈õƒá notatki"></textarea>
          <label style="display:flex;align-items:center;gap:7px;font-size:13px"><input id="note-pin" type="checkbox" style="width:auto"> Przypnij jako wa≈ºne</label>
          <button id="note-save" class="btn primary">Zapisz notatkƒô</button>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
const STORE='lifeos_task_hub_v2';
const DEFAULT_MEMBERS=[
  {id:'m1',name:'Pracownik 1',role:'',color:'#6366f1'},
  {id:'m2',name:'Pracownik 2',role:'',color:'#f59e0b'},
  {id:'m3',name:'Pracownik 3',role:'',color:'#10b981'},
  {id:'m4',name:'Pracownik 4',role:'',color:'#ef4444'}
];
const legacy=JSON.parse(localStorage.getItem('lifeos_workhub_v1')||'null');
let S={myTasks:[],members:[...DEFAULT_MEMBERS],teamTasks:[],notes:[]};
if(legacy&&typeof legacy==='object'){
  S.myTasks=(legacy.tasks||[]).map(t=>normTask(t,'me'));
  S.teamTasks=(legacy.teamTasks||[]).map(t=>normTask(t,t.assigneeId||'m1'));
  S.notes=(legacy.notes||[]).map(normNote);
  if(Array.isArray(legacy.members)&&legacy.members.length)S.members=legacy.members;
}
const now=JSON.parse(localStorage.getItem(STORE)||'null');
if(now&&typeof now==='object')S=now;
let selMember='';

function id(p){return `${p}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`}
function save(){localStorage.setItem(STORE,JSON.stringify(S));renderAll()}
function esc(v=''){return v.replace(/[&<>\"]/g,ch=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[ch]))}
function normTask(t={},assignee){
  const steps=Array.isArray(t.steps)?t.steps:(Array.isArray(t.subtasks)?t.subtasks.map(s=>({id:s.id||id('st'),text:s.text||'',done:!!s.done})):[]);
  return {id:t.id||id('t'),title:(t.title||'Bez nazwy').trim(),assigneeId:assignee||t.assigneeId||'me',status:t.status==='done'?'done':'todo',priority:['high','medium','low'].includes(t.priority)?t.priority:'medium',dueDate:t.dueDate||'',steps:steps.filter(s=>s.text&&s.text.trim()).map(s=>({id:s.id||id('st'),text:s.text.trim(),done:!!s.done}))};
}
function normNote(n={}){return{id:n.id||id('n'),personId:n.personId||'me',title:(n.title||'').trim(),seriesKey:(n.seriesKey||'').trim(),content:(n.content||'').trim(),pinned:!!n.pinned,updatedAt:n.updatedAt||new Date().toISOString()}}
function splitSteps(text){return text.split('\n').map(x=>x.trim()).filter(Boolean).map(v=>({id:id('st'),text:v,done:false}))}
function prioWeight(p){return ({high:0,medium:1,low:2})[p]??1}

function renderAll(){renderKpis();renderMy();renderMembers();renderNotes();wireSidebar()}
function wireSidebar(){const cp='tasks';document.querySelectorAll('.sidebar__link').forEach(l=>{l.classList.toggle('is-active',l.dataset.page===cp);if(l.dataset.page===cp)l.setAttribute('aria-current','page')})}

function renderKpis(){
  const all=[...S.myTasks,...S.teamTasks],todo=all.filter(t=>t.status==='todo'),done=all.filter(t=>t.status==='done');
  const withDates=todo.filter(t=>t.dueDate);const overdue=withDates.filter(t=>new Date(t.dueDate)<new Date(new Date().toDateString()));
  const out=[
    ['Wszystkie taski',all.length],['Aktywne',todo.length],['Po terminie',overdue.length],['Uko≈Ñczone',done.length]
  ];
  document.getElementById('kpis').innerHTML=out.map(([l,v])=>`<div class="card kpi"><div class="v">${v}</div><div class="l">${l}</div></div>`).join('');
}

function renderMy(){
  const body=document.getElementById('my-rows');
  const rows=[...S.myTasks].sort((a,b)=>prioWeight(a.priority)-prioWeight(b.priority));
  body.innerHTML=rows.map(t=>`<tr>
    <td><input data-my-done="${t.id}" type="checkbox" ${t.status==='done'?'checked':''}></td>
    <td><strong>${esc(t.title)}</strong></td>
    <td><div class="steps">${t.steps.length?t.steps.map(s=>`<label class="step"><input type="checkbox" data-my-step="${t.id}|${s.id}" ${s.done?'checked':''}><span>${esc(s.text)}</span></label>`).join(''):'<span class="muted">Brak</span>'}</div></td>
    <td>${t.dueDate||'‚Äî'}</td>
    <td><span class="pill ${t.priority}">${({high:'Wysoki',medium:'≈öredni',low:'Niski'})[t.priority]}</span></td>
    <td><button data-my-del="${t.id}" class="btn sm">Usu≈Ñ</button></td>
  </tr>`).join('')||'<tr><td colspan="6" class="muted">Brak task√≥w.</td></tr>';

  body.querySelectorAll('[data-my-done]').forEach(el=>el.onchange=e=>{const t=S.myTasks.find(x=>x.id===e.target.dataset.myDone);if(!t)return;t.status=e.target.checked?'done':'todo';save()});
  body.querySelectorAll('[data-my-step]').forEach(el=>el.onchange=e=>{const[tid,sid]=e.target.dataset.myStep.split('|');const t=S.myTasks.find(x=>x.id===tid);if(!t)return;const st=t.steps.find(x=>x.id===sid);if(st)st.done=e.target.checked;if(t.steps.length&&t.steps.every(s=>s.done))t.status='done';save()});
  body.querySelectorAll('[data-my-del]').forEach(el=>el.onclick=e=>{S.myTasks=S.myTasks.filter(x=>x.id!==e.target.dataset.myDel);save()});
}

function renderMembers(){
  const list=document.getElementById('member-list');
  list.innerHTML=S.members.map(m=>{const a=S.teamTasks.filter(t=>t.assigneeId===m.id&&t.status==='todo').length;return `<div class="member ${selMember===m.id?'active':''}" data-member="${m.id}"><div class="avatar" style="background:${m.color}">${m.name[0]?.toUpperCase()||'?'}</div><div><div><strong>${esc(m.name)}</strong></div><small>${esc(m.role||'Bez roli')} ‚Ä¢ ${a} aktywnych</small></div></div>`}).join('');
  list.querySelectorAll('[data-member]').forEach(el=>el.onclick=()=>{selMember=el.dataset.member;renderTeamDetail();renderMembers()});
  renderTeamDetail();
}

function renderTeamDetail(){
  const empty=document.getElementById('team-empty'),detail=document.getElementById('team-detail');
  if(!selMember){empty.style.display='block';detail.style.display='none';return;}
  const m=S.members.find(x=>x.id===selMember);if(!m)return;
  empty.style.display='none';detail.style.display='block';
  const tasks=S.teamTasks.filter(t=>t.assigneeId===m.id);
  const col=(prio,label)=>`<div class="col" data-drop="${prio}"><h4>${label}</h4>${tasks.filter(t=>t.priority===prio).sort((a,b)=>a.status.localeCompare(b.status)).map(taskCard).join('')}</div>`;
  detail.innerHTML=`
    <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px"><div><h3 style="margin:0">${esc(m.name)}</h3><div class="muted" style="font-size:13px">PrzeciƒÖgnij kartƒô miƒôdzy kolumnami, aby zmieniƒá priorytet.</div></div></div>
    <div class="board">${col('high','üî¥ Wysoki')}${col('medium','üü† ≈öredni')}${col('low','üîµ Niski')}</div>
    <div class="card form" style="margin-top:10px;border-radius:12px">
      <h4 style="margin:0">Nowy task dla ${esc(m.name.split(' ')[0])}</h4>
      <input id="tt-title" placeholder="Nazwa taska">
      <textarea id="tt-steps" rows="3" placeholder="Kroki (ka≈ºda linia osobno)"></textarea>
      <div class="grid2"><input id="tt-due" type="date"><select id="tt-prio"><option value="medium">≈öredni</option><option value="high">Wysoki</option><option value="low">Niski</option></select></div>
      <button class="btn primary" id="tt-add">Dodaj</button>
    </div>`;

  detail.querySelectorAll('.task').forEach(el=>{
    el.draggable=true;
    el.addEventListener('dragstart',ev=>{el.classList.add('dragging');ev.dataTransfer.setData('text/plain',el.dataset.id)});
    el.addEventListener('dragend',()=>el.classList.remove('dragging'));
  });
  detail.querySelectorAll('[data-drop]').forEach(col=>{
    col.addEventListener('dragover',e=>e.preventDefault());
    col.addEventListener('drop',e=>{e.preventDefault();const taskId=e.dataTransfer.getData('text/plain');const t=S.teamTasks.find(x=>x.id===taskId);if(!t)return;t.priority=col.dataset.drop;save();});
  });
  detail.querySelectorAll('[data-team-done]').forEach(el=>el.onchange=e=>{const t=S.teamTasks.find(x=>x.id===e.target.dataset.teamDone);if(!t)return;t.status=e.target.checked?'done':'todo';save()});
  detail.querySelectorAll('[data-team-step]').forEach(el=>el.onchange=e=>{const[tid,sid]=e.target.dataset.teamStep.split('|');const t=S.teamTasks.find(x=>x.id===tid);if(!t)return;const st=t.steps.find(x=>x.id===sid);if(st)st.done=e.target.checked;if(t.steps.length&&t.steps.every(s=>s.done))t.status='done';save()});
  detail.querySelectorAll('[data-team-del]').forEach(el=>el.onclick=e=>{S.teamTasks=S.teamTasks.filter(x=>x.id!==e.target.dataset.teamDel);save()});
  detail.querySelector('#tt-add').onclick=()=>{
    const title=detail.querySelector('#tt-title').value.trim();if(!title)return;
    S.teamTasks.push(normTask({title,dueDate:detail.querySelector('#tt-due').value,priority:detail.querySelector('#tt-prio').value,steps:splitSteps(detail.querySelector('#tt-steps').value)},m.id));
    save();
  };
}

function taskCard(t){return `<div class="task" data-id="${t.id}"><div class="task-top"><span class="task-title">${esc(t.title)}</span><button class="btn sm" data-team-del="${t.id}">√ó</button></div><div class="task-meta">${t.dueDate?`üìÖ ${t.dueDate}`:'Bez terminu'}</div><label class="step" style="margin-top:6px"><input type="checkbox" data-team-done="${t.id}" ${t.status==='done'?'checked':''}><span>${t.status==='done'?'Uko≈Ñczony':'W toku'}</span></label><div class="steps" style="margin-top:4px">${t.steps.map(s=>`<label class="step"><input type="checkbox" data-team-step="${t.id}|${s.id}" ${s.done?'checked':''}><span>${esc(s.text)}</span></label>`).join('')}</div></div>`}

function renderNotes(){
  const sel=document.getElementById('note-person');
  sel.innerHTML=['<option value="me">Ja</option>',...S.members.map(m=>`<option value="${m.id}">${esc(m.name)}</option>` )].join('');
  const notes=[...S.notes].sort((a,b)=>Number(b.pinned)-Number(a.pinned)||b.updatedAt.localeCompare(a.updatedAt));
  document.getElementById('note-list').innerHTML=notes.map(n=>{
    const person=n.personId==='me'?'Ja':(S.members.find(m=>m.id===n.personId)?.name||'‚Äî');
    return `<div class="sticky ${n.pinned?'pinned':''}"><div style="display:flex;justify-content:space-between;gap:6px"><h5>${esc(n.title||'Notatka')}</h5><span class="badge">${esc(person)}</span></div><small>${n.seriesKey?`Seria: ${esc(n.seriesKey)} ¬∑ `:''}Aktualizacja: ${new Date(n.updatedAt).toLocaleString('pl-PL')}</small><div class="txt">${esc(n.content)}</div><div style="display:flex;gap:6px"><button class="btn sm" data-pin="${n.id}">${n.pinned?'Odepnij':'Przypnij'}</button><button class="btn sm" data-del-note="${n.id}">Usu≈Ñ</button></div></div>`;
  }).join('')||'<div class="muted">Brak notatek.</div>';

  document.querySelectorAll('[data-pin]').forEach(b=>b.onclick=e=>{const n=S.notes.find(x=>x.id===e.target.dataset.pin);if(!n)return;n.pinned=!n.pinned;n.updatedAt=new Date().toISOString();save()});
  document.querySelectorAll('[data-del-note]').forEach(b=>b.onclick=e=>{S.notes=S.notes.filter(x=>x.id!==e.target.dataset.delNote);save()});
}

// events
Array.from(document.querySelectorAll('.tab')).forEach(tab=>tab.onclick=()=>{
  document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active',t===tab));
  const id=tab.dataset.tab;document.querySelectorAll('.module').forEach(m=>m.classList.remove('active'));document.getElementById(`mod-${id}`).classList.add('active');
});

document.getElementById('my-add').onclick=()=>{
  const title=document.getElementById('my-title').value.trim();if(!title)return;
  S.myTasks.push(normTask({title,priority:document.getElementById('my-priority').value,dueDate:document.getElementById('my-due').value,steps:splitSteps(document.getElementById('my-steps').value)},'me'));
  document.getElementById('my-title').value='';document.getElementById('my-steps').value='';document.getElementById('my-due').value='';save();
};

document.getElementById('note-save').onclick=()=>{
  const personId=document.getElementById('note-person').value;
  const title=document.getElementById('note-title').value.trim();
  const seriesKey=document.getElementById('note-series').value.trim();
  const content=document.getElementById('note-content').value.trim();
  const pinned=document.getElementById('note-pin').checked;
  if(!content)return;
  const existing=seriesKey?S.notes.find(n=>n.personId===personId&&n.seriesKey.toLowerCase()===seriesKey.toLowerCase()):null;
  if(existing){existing.title=title||existing.title;existing.content=content;existing.pinned=pinned;existing.updatedAt=new Date().toISOString();}
  else S.notes.unshift(normNote({personId,title,seriesKey,content,pinned,updatedAt:new Date().toISOString()}));
  document.getElementById('note-title').value='';document.getElementById('note-series').value='';document.getElementById('note-content').value='';document.getElementById('note-pin').checked=false;
  save();
};

document.getElementById('export').onclick=()=>{const b=new Blob([JSON.stringify(S,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='lifeos-task-hub.json';a.click();}

document.getElementById('import').onclick=()=>{const i=document.createElement('input');i.type='file';i.accept='.json';i.onchange=e=>{const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=ev=>{try{const p=JSON.parse(ev.target.result);if(!p)throw new Error();S=p;save();}catch{alert('B≈Çƒôdny plik JSON');}};r.readAsText(f)};i.click()}

renderAll();
</script>
</body>
</html>
